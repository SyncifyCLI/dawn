{
  "version": 3,
  "sources": ["../../source/assets/scripts/cart-drawer.js"],
  "sourcesContent": ["class CartDrawer extends HTMLElement {\n  constructor() {\n    super();\n\n    this.addEventListener('keyup', (evt) => evt.code === 'Escape' && this.close());\n    this.querySelector('#CartDrawer-Overlay').addEventListener('click', this.close.bind(this));\n    this.setHeaderCartIconAccessibility();\n  }\n\n  setHeaderCartIconAccessibility() {\n    const cartLink = document.querySelector('#cart-icon-bubble');\n    if (!cartLink) return;\n\n    cartLink.setAttribute('role', 'button');\n    cartLink.setAttribute('aria-haspopup', 'dialog');\n    cartLink.addEventListener('click', (event) => {\n      event.preventDefault();\n      this.open(cartLink);\n    });\n    cartLink.addEventListener('keydown', (event) => {\n      if (event.code.toUpperCase() === 'SPACE') {\n        event.preventDefault();\n        this.open(cartLink);\n      }\n    });\n  }\n\n  open(triggeredBy) {\n    if (triggeredBy) this.setActiveElement(triggeredBy);\n    const cartDrawerNote = this.querySelector('[id^=\"Details-\"] summary');\n    if (cartDrawerNote && !cartDrawerNote.hasAttribute('role')) this.setSummaryAccessibility(cartDrawerNote);\n    // here the animation doesn't seem to always get triggered. A timeout seem to help\n    setTimeout(() => {\n      this.classList.add('animate', 'active');\n    });\n\n    this.addEventListener(\n      'transitionend',\n      () => {\n        const containerToTrapFocusOn = this.classList.contains('is-empty')\n          ? this.querySelector('.drawer__inner-empty')\n          : document.getElementById('CartDrawer');\n        const focusElement = this.querySelector('.drawer__inner') || this.querySelector('.drawer__close');\n        trapFocus(containerToTrapFocusOn, focusElement);\n      },\n      { once: true }\n    );\n\n    document.body.classList.add('overflow-hidden');\n  }\n\n  close() {\n    this.classList.remove('active');\n    removeTrapFocus(this.activeElement);\n    document.body.classList.remove('overflow-hidden');\n  }\n\n  setSummaryAccessibility(cartDrawerNote) {\n    cartDrawerNote.setAttribute('role', 'button');\n    cartDrawerNote.setAttribute('aria-expanded', 'false');\n\n    if (cartDrawerNote.nextElementSibling.getAttribute('id')) {\n      cartDrawerNote.setAttribute('aria-controls', cartDrawerNote.nextElementSibling.id);\n    }\n\n    cartDrawerNote.addEventListener('click', (event) => {\n      event.currentTarget.setAttribute('aria-expanded', !event.currentTarget.closest('details').hasAttribute('open'));\n    });\n\n    cartDrawerNote.parentElement.addEventListener('keyup', onKeyUpEscape);\n  }\n\n  renderContents(parsedState) {\n    this.querySelector('.drawer__inner').classList.contains('is-empty') &&\n      this.querySelector('.drawer__inner').classList.remove('is-empty');\n    this.productId = parsedState.id;\n    this.getSectionsToRender().forEach((section) => {\n      const sectionElement = section.selector\n        ? document.querySelector(section.selector)\n        : document.getElementById(section.id);\n\n      if (!sectionElement) return;\n      sectionElement.innerHTML = this.getSectionInnerHTML(parsedState.sections[section.id], section.selector);\n    });\n\n    setTimeout(() => {\n      this.querySelector('#CartDrawer-Overlay').addEventListener('click', this.close.bind(this));\n      this.open();\n    });\n  }\n\n  getSectionInnerHTML(html, selector = '.shopify-section') {\n    return new DOMParser().parseFromString(html, 'text/html').querySelector(selector).innerHTML;\n  }\n\n  getSectionsToRender() {\n    return [\n      {\n        id: 'cart-drawer',\n        selector: '#CartDrawer',\n      },\n      {\n        id: 'cart-icon-bubble',\n      },\n    ];\n  }\n\n  getSectionDOM(html, selector = '.shopify-section') {\n    return new DOMParser().parseFromString(html, 'text/html').querySelector(selector);\n  }\n\n  setActiveElement(element) {\n    this.activeElement = element;\n  }\n}\n\ncustomElements.define('cart-drawer', CartDrawer);\n\nclass CartDrawerItems extends CartItems {\n  getSectionsToRender() {\n    return [\n      {\n        id: 'CartDrawer',\n        section: 'cart-drawer',\n        selector: '.drawer__inner',\n      },\n      {\n        id: 'cart-icon-bubble',\n        section: 'cart-icon-bubble',\n        selector: '.shopify-section',\n      },\n    ];\n  }\n}\n\ncustomElements.define('cart-drawer-items', CartDrawerItems);\n"],
  "mappings": "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",
  "names": ["CartDrawer", "evt", "cartLink", "event", "triggeredBy", "cartDrawerNote", "containerToTrapFocusOn", "focusElement", "parsedState", "section", "sectionElement", "html", "selector", "element", "CartDrawerItems"]
}
