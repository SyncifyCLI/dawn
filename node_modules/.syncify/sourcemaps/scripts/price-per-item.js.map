{
  "version": 3,
  "sources": ["../../source/assets/scripts/price-per-item.js"],
  "sourcesContent": ["if (!customElements.get('price-per-item')) {\n  customElements.define(\n    'price-per-item',\n    class PricePerItem extends HTMLElement {\n      constructor() {\n        super();\n        this.variantId = this.dataset.variantId;\n        this.input = document.getElementById(`Quantity-${this.dataset.sectionId || this.dataset.variantId}`);\n        if (this.input) {\n          this.input.addEventListener('change', this.onInputChange.bind(this));\n        }\n\n        this.getVolumePricingArray();\n      }\n\n      updatePricePerItemUnsubscriber = undefined;\n      variantIdChangedUnsubscriber = undefined;\n\n      connectedCallback() {\n        // Update variantId if variant is switched on product page\n        this.variantIdChangedUnsubscriber = subscribe(PUB_SUB_EVENTS.variantChange, (event) => {\n          this.variantId = event.data.variant.id.toString();\n          this.getVolumePricingArray();\n        });\n\n        this.updatePricePerItemUnsubscriber = subscribe(PUB_SUB_EVENTS.cartUpdate, (response) => {\n          if (!response.cartData) return;\n\n          // Item was added to cart via product page\n          if (response.cartData['variant_id'] !== undefined) {\n            if (response.productVariantId === this.variantId) this.updatePricePerItem(response.cartData.quantity);\n            // Qty was updated in cart\n          } else if (response.cartData.item_count !== 0) {\n            const isVariant = response.cartData.items.find((item) => item.variant_id.toString() === this.variantId);\n            if (isVariant && isVariant.id.toString() === this.variantId) {\n              // The variant is still in cart\n              this.updatePricePerItem(isVariant.quantity);\n            } else {\n              // The variant was removed from cart, qty is 0\n              this.updatePricePerItem(0);\n            }\n            // All items were removed from cart\n          } else {\n            this.updatePricePerItem(0);\n          }\n        });\n      }\n\n      disconnectedCallback() {\n        if (this.updatePricePerItemUnsubscriber) {\n          this.updatePricePerItemUnsubscriber();\n        }\n        if (this.variantIdChangedUnsubscriber) {\n          this.variantIdChangedUnsubscriber();\n        }\n      }\n\n      onInputChange() {\n        this.updatePricePerItem();\n      }\n\n      updatePricePerItem(updatedCartQuantity) {\n        if (this.input) {\n          this.enteredQty = parseInt(this.input.value);\n          this.step = parseInt(this.input.step)\n        }\n\n        // updatedCartQuantity is undefined when qty is updated on product page. We need to sum entered qty and current qty in cart.\n        // updatedCartQuantity is not undefined when qty is updated in cart. We need to sum qty in cart and min qty for product.\n        this.currentQtyForVolumePricing = updatedCartQuantity === undefined ? this.getCartQuantity(updatedCartQuantity) + this.enteredQty : this.getCartQuantity(updatedCartQuantity) + parseInt(this.step);\n\n        if (this.classList.contains('variant-item__price-per-item')) {\n          this.currentQtyForVolumePricing = this.getCartQuantity(updatedCartQuantity);\n        }\n        for (let pair of this.qtyPricePairs) {\n          if (this.currentQtyForVolumePricing >= pair[0]) {\n            const pricePerItemCurrent = document.querySelector(`price-per-item[id^=\"Price-Per-Item-${this.dataset.sectionId || this.dataset.variantId}\"] .price-per-item span`);\n            this.classList.contains('variant-item__price-per-item') ? pricePerItemCurrent.innerHTML = window.quickOrderListStrings.each.replace('[money]', pair[1]) : pricePerItemCurrent.innerHTML = pair[1];\n            break;\n          }\n        }\n      }\n\n      getCartQuantity(updatedCartQuantity) {\n        return (updatedCartQuantity || updatedCartQuantity === 0) ? updatedCartQuantity : parseInt(this.input.dataset.cartQuantity);\n      }\n\n      getVolumePricingArray() {\n        const volumePricing = document.getElementById(`Volume-${this.dataset.sectionId || this.dataset.variantId}`);\n        this.qtyPricePairs = [];\n\n        if (volumePricing) {\n          volumePricing.querySelectorAll('li').forEach(li => {\n            const qty = parseInt(li.querySelector('span:first-child').textContent);\n            const price = (li.querySelector('span:not(:first-child):last-child').dataset.text);\n            this.qtyPricePairs.push([qty, price]);\n          });\n        }\n        this.qtyPricePairs.reverse();\n      }\n    }\n  );\n}\n"],
  "mappings": "oKAAK,eAAe,IAAI,gBAAgB,GACtC,eAAe,OACb,iBACA,cAA2B,WAAY,CACrC,aAAc,CACZ,MAAM,EAURA,EAAA,uCACAA,EAAA,qCAVE,KAAK,UAAY,KAAK,QAAQ,UAC9B,KAAK,MAAQ,SAAS,eAAe,YAAY,KAAK,QAAQ,WAAa,KAAK,QAAQ,SAAS,EAAE,EAC/F,KAAK,OACP,KAAK,MAAM,iBAAiB,SAAU,KAAK,cAAc,KAAK,IAAI,CAAC,EAGrE,KAAK,sBAAsB,CAC7B,CAKA,mBAAoB,CAElB,KAAK,6BAA+B,UAAU,eAAe,cAAgBC,GAAU,CACrF,KAAK,UAAYA,EAAM,KAAK,QAAQ,GAAG,SAAS,EAChD,KAAK,sBAAsB,CAC7B,CAAC,EAED,KAAK,+BAAiC,UAAU,eAAe,WAAaC,GAAa,CACvF,GAAKA,EAAS,SAGd,GAAIA,EAAS,SAAS,aAAkB,OAClCA,EAAS,mBAAqB,KAAK,WAAW,KAAK,mBAAmBA,EAAS,SAAS,QAAQ,UAE3FA,EAAS,SAAS,aAAe,EAAG,CAC7C,IAAMC,EAAYD,EAAS,SAAS,MAAM,KAAME,GAASA,EAAK,WAAW,SAAS,IAAM,KAAK,SAAS,EAClGD,GAAaA,EAAU,GAAG,SAAS,IAAM,KAAK,UAEhD,KAAK,mBAAmBA,EAAU,QAAQ,EAG1C,KAAK,mBAAmB,CAAC,CAG7B,MACE,KAAK,mBAAmB,CAAC,CAE7B,CAAC,CACH,CAEA,sBAAuB,CACjB,KAAK,gCACP,KAAK,+BAA+B,EAElC,KAAK,8BACP,KAAK,6BAA6B,CAEtC,CAEA,eAAgB,CACd,KAAK,mBAAmB,CAC1B,CAEA,mBAAmBE,EAAqB,CAClC,KAAK,QACP,KAAK,WAAa,SAAS,KAAK,MAAM,KAAK,EAC3C,KAAK,KAAO,SAAS,KAAK,MAAM,IAAI,GAKtC,KAAK,2BAA6BA,IAAwB,OAAY,KAAK,gBAAgBA,CAAmB,EAAI,KAAK,WAAa,KAAK,gBAAgBA,CAAmB,EAAI,SAAS,KAAK,IAAI,EAE9L,KAAK,UAAU,SAAS,8BAA8B,IACxD,KAAK,2BAA6B,KAAK,gBAAgBA,CAAmB,GAE5E,QAASC,KAAQ,KAAK,cACpB,GAAI,KAAK,4BAA8BA,EAAK,CAAC,EAAG,CAC9C,IAAMC,EAAsB,SAAS,cAAc,sCAAsC,KAAK,QAAQ,WAAa,KAAK,QAAQ,SAAS,yBAAyB,EAClK,KAAK,UAAU,SAAS,8BAA8B,EAAIA,EAAoB,UAAY,OAAO,sBAAsB,KAAK,QAAQ,UAAWD,EAAK,CAAC,CAAC,EAAIC,EAAoB,UAAYD,EAAK,CAAC,EAChM,KACF,CAEJ,CAEA,gBAAgBD,EAAqB,CACnC,OAAQA,GAAuBA,IAAwB,EAAKA,EAAsB,SAAS,KAAK,MAAM,QAAQ,YAAY,CAC5H,CAEA,uBAAwB,CACtB,IAAMG,EAAgB,SAAS,eAAe,UAAU,KAAK,QAAQ,WAAa,KAAK,QAAQ,SAAS,EAAE,EAC1G,KAAK,cAAgB,CAAC,EAElBA,GACFA,EAAc,iBAAiB,IAAI,EAAE,QAAQC,GAAM,CACjD,IAAMC,EAAM,SAASD,EAAG,cAAc,kBAAkB,EAAE,WAAW,EAC/DE,EAASF,EAAG,cAAc,mCAAmC,EAAE,QAAQ,KAC7E,KAAK,cAAc,KAAK,CAACC,EAAKC,CAAK,CAAC,CACtC,CAAC,EAEH,KAAK,cAAc,QAAQ,CAC7B,CACF,CACF",
  "names": ["__publicField", "event", "response", "isVariant", "item", "updatedCartQuantity", "pair", "pricePerItemCurrent", "volumePricing", "li", "qty", "price"]
}
